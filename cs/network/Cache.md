# 1. 로컬 스토리지

* 웹 스토리지 객체로 브라우저 내에 { key : value } 형태로 오리진에 종속되어 저장되는 데이터
    * 하나의 키에 오로지 하나의 값만 저장됨
    * 데이터는 사용자가 브라우저에서 수동으로 삭제하지 않는 한 **평생동안 로컬 저장소에 저장**되며 만료날짜가 없음
    * 사용자가 창이나 탭을 닫거나 컴퓨터를 종료해도 만료되지 않음
    * 최대 저장용량은 5MB
    * 보통 사용자의 행위를 기억할 때, 로그인을 유지하기 위한 값 등으로 사용되며 로컬 스토리지 데이터는 자동으로 서버로 전송되지 않음(쿠키는 자동 전송됨)

# 2. 로컬 스토리지 활용 사례: 캐싱

* UX 개선을 위해 텍스트 창에 입력한 값을 로컬스토리지를 통해 캐싱

# 3. 세션 스토리지

* 동일한 오리진이라도 브라우저의 각 **탭**마다 독립적으로 저장됨
* 즉, 다른 탭에서 세션 스토리지에 저장된 데이터에 접근할 수 없음
    * 하나의 키에 하나의 값만 저장
    * 최대 저장용량은 5MB
    * **사용자가 브라우저에서 탭을 닫으면 데이터 만료**
* 보통 세션스토리지보다는 로컬스토리지를 많이 사용

# 4. 쿠키

* 브라우저에 저장된 데이터 조각
* 보통은 서버에서 먼저 설정해서 쿠키를 만드는 게 일반적
    * 서버에서 응답 헤더로 Set-Cookie 설정해서 쿠키를 보내면 클라이언트에서 요청 헤더 Cookie에 설정되어 자동으로 서버에 전달되게 되고 브라우저에도 저장되게 됨
    * 클라이언트와 서버에서 모두 조작 가능하지만 보통 서버에서 만료기한 등을 설정 및 컨트롤함
    * 민감 정보가 담길 수 있기 때문에 쿠키 제어권을 나누지 않고 서버에서 갖게 해야 함
* 최대 저장용량은 4kb
* 보통 로그인, 장바구니, 사용자 커스터마이징, 사용자 행동분석(개인화 광고)에 사용됨

## 1. 세션 쿠키

* Expires 또는 Max-Age 속성을 지정하지 않은 것
* 브라우저가 종료되면 쿠키도 사라짐

## 2. 영구 쿠기

* Expires 또는 Max-Age 속성을 지정해서 특정 날짜 또는 일정 기간이 지나면 삭제되게 만든 쿠키, 브라우저를 닫을 때 만료되지 않음

## 3. 문법

### secure

* https로만 쿠키를 주고 받을 수 있게 하는 옵션
* Chrome v89 및 Firefor v75 이상의 localhost에서는 이 사양을 무시해서 쉽게 테스팅 가능

### httponly

* 공격자가 쿠키를 자바스크립트로 빼낼 수 없게 만듬
* 즉, document.cookie로 접근 불가

### samesite

* 요청이 동일한 도메인에서 시작된 경우에만 쿠키가 애플리케이션으로 전송되도록 허용

## 4. 쿠키의 시큐어코딩

* 쿠키 - 세션으로 **로그인**을 처리한다면 다음과 같은 시큐어 코딩을 해야 함

1. cookie에 세션ID를 담을 때 이 **세션ID**를 기반으로 클라이언트의 개인정보를 **유추**할 수 없게 해야 함
2. 자바스크립트로는 파악할 수 없게 **http only** 옵션을 걸고 https로만 쿠키를 주고 받을 수 있게 **secure** 옵션을 걸어야 함
3. 일정 시간의 **세션 타임아웃**을 걸어야 함

# 5. 로컬 스토리지, 세션 스토리지, 쿠키 의 공통점과 차이점

## 공통점

1. 브라우저에 캐싱을 함 -> 서버에 대한 요청을 줄여 서버 부하 방지
2. 캐싱으로 인해 다운로드하는 컨텐츠가 줄어들어 웹사이트를 더 빨리 로드 가능
3. 사이트 기본 설정 커스터마이징을 저장하거나 로그인 상태를 유지할 때 사용 가능

## 차이점

|                         | 쿠키         | 로컬 스토리지 | 세션 스토리지  |
|-------------------------|------------|---------|----------|
| **최대 저장 용량**            | 4KB        | 5MB     | 5MB      |
| **브라우저 허용**             | HTML4 + 5  | HTML 5  | HTML 5   |
| **접근 범위**               | 오리진        | 오리진     | 탭        |
| **만료 기한**               | 수동으로 설정    | 영구적     | 탭 닫으면 소멸 |
| **설정할 수 있는 주체**         | 클라이언트 + 서버 | 클라이언트   | 클라이언트    |
| **요청과 함께 서버에 자동 전송 유무** | O          | X       | X        |
